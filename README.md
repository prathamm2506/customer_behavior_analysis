# Customer Behavior Analysis

## Overview
This project analyzes customer shopping behavior using a dataset of customer purchases. The analysis includes data cleaning, feature engineering, and SQL-based queries to derive insights such as revenue by gender, top-rated products, subscription impact, and more.

## Dataset
- **Raw Data**: `customer_shopping_behavior.csv` - Contains raw customer purchase data.
- **Cleaned Data**: `cleaned_data.csv` - Processed dataset after cleaning and feature engineering.

Key columns in cleaned data:
- customer_id
- age
- gender
- item_purchased
- category
- purchase_amount
- location
- size
- color
- season
- review_rating
- subscription_status
- shipping_type
- discount_applied
- previous_purchases
- payment_method
- age_group (derived)
- purchase_frequency_days (derived)

## Data Cleaning and Preparation
The data cleaning process is performed in `Customer_Shopping_Behavior.ipynb`:
- Handle missing values (e.g., fill review ratings with median by category).
- Standardize column names (lowercase, replace spaces with underscores).
- Rename columns for clarity (e.g., `purchase_amount_(usd)` to `purchase_amount`).
- Create new features:
  - `age_group`: Categorized into 'Young Adult', 'Adult', 'Middle Aged', 'Senior'.
  - `purchase_frequency_days`: Mapped from frequency strings to days.
- Remove redundant columns (e.g., `promo_code_used` as it matches `discount_applied`).

## Analysis Queries
The `queries.sql` file contains 10 SQL queries for analysis. These can be run on the cleaned data using a SQL engine or pandasql in Python.

### Query List:
1. **Total Revenue by Gender**: Revenue generated by male vs. female customers.
2. **Discount Users Above Average Spend**: Customers who used discounts but spent more than average.
3. **Top 5 Products by Average Rating**: Highest-rated products.
4. **Average Purchase by Shipping Type**: Compare Standard and Express shipping.
5. **Subscribers vs. Non-Subscribers**: Average spend and total revenue comparison.
6. **Discount Rate by Product**: Top 5 products with highest discount usage percentage.
7. **Customer Segmentation**: Count of New, Returning, and Loyal customers based on previous purchases.
8. **Top 3 Products per Category**: Most purchased items within each category.
9. **Repeat Buyers and Subscription**: Likelihood of subscription among repeat buyers (>5 purchases).
10. **Revenue by Age Group**: Total revenue contribution per age group.

## Requirements
- Python 3.x
- Libraries: pandas, pandasql (for SQL queries in Python)
- Jupyter Notebook (for running the cleaning script)

Install dependencies:
```
pip install pandas pandasql jupyter
```

## Usage
1. **Data Cleaning**:
   - Open `Customer_Shopping_Behavior.ipynb` in Jupyter.
   - Run the cells to clean the data and generate `cleaned_data.csv`.

2. **Running Queries**:
   - Use pandasql in a Python script or notebook to execute the queries on `cleaned_data.csv`.
   - Example Python script to run queries:
     ```python
     import pandas as pd
     import pandasql as ps

     df = pd.read_csv('cleaned_data.csv')
     # Example: Run Q1
     query = "SELECT gender, SUM(purchase_amount) as revenue FROM df GROUP BY gender;"
     result = ps.sqldf(query, locals())
     print(result)
     ```

3. **Reports**:
   - View generated reports: `Customer Behavior Analysis Report.pdf`, `Customer-Shopping-Behavior-Analysis.pdf`.

## File Structure
- `customer_shopping_behavior.csv`: Raw dataset.
- `cleaned_data.csv`: Cleaned dataset.
- `Customer_Shopping_Behavior.ipynb`: Jupyter notebook for data cleaning.
- `queries.sql`: SQL queries for analysis.
- `Customer Behavior Analysis Report.pdf`: Analysis report.
- `Customer-Shopping-Behavior-Analysis.pdf`: Additional report.
- `.git/`: Git repository.
